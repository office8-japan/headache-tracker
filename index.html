<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é ­ç—›è¨˜éŒ²ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-10">

    <header class="bg-indigo-600 text-white p-4 shadow-lg mb-6">
        <div class="max-w-2xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold">ğŸ¤• é ­ç—›è¨˜éŒ²ãƒãƒ¼ãƒˆ</h1>
            <span id="currentDate" class="text-sm opacity-80"></span>
        </div>
    </header>

    <main class="max-w-2xl mx-auto px-4 space-y-6">
        
        <section class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
            <h2 class="text-lg font-semibold mb-4 text-gray-700">ä»Šã®çŠ¶æ³ã‚’è¨˜éŒ²</h2>
            <form id="headacheForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">ç—›ã¿ã®å¼·ã• (1-10)</label>
                    <input type="range" id="intensity" min="1" max="10" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                    <div class="flex justify-between text-xs text-gray-500 px-1 mt-1">
                        <span>å¼±</span><span>ä¸­</span><span>å¼·</span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-1">éƒ¨ä½</label>
                        <select id="location" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500 border p-2 bg-white">
                            <option value="ã“ã‚ã‹ã¿">ã“ã‚ã‹ã¿</option>
                            <option value="å¾Œé ­éƒ¨">å¾Œé ­éƒ¨</option>
                            <option value="é ­å…¨ä½“">é ­å…¨ä½“</option>
                            <option value="ç›®ã®å¥¥">ç›®ã®å¥¥</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-1">è–¬ã®æœç”¨</label>
                        <select id="medication" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500 border p-2 bg-white">
                            <option value="ãªã—">ãªã—</option>
                            <option value="ã‚ã‚Š">ã‚ã‚Š</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">ãƒ¡ãƒ¢</label>
                    <textarea id="memo" rows="2" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500 border p-2" placeholder="ç¡çœ ä¸è¶³ã€å¤©å€™ãªã©..."></textarea>
                </div>

                <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 transition duration-200">
                    è¨˜éŒ²ã‚’ä¿å­˜ã™ã‚‹
                </button>
            </form>
        </section>

        <section class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
            <h2 class="text-lg font-semibold mb-4 text-gray-700">ç—›ã¿ã®æ¨ç§»</h2>
            <canvas id="headacheChart" height="150"></canvas>
        </section>

        <section>
            <h2 class="text-lg font-semibold mb-3 text-gray-700">æœ€è¿‘ã®è¨˜éŒ²</h2>
            <div id="historyList" class="space-y-3">
                </div>
            <button id="clearData" class="mt-6 text-sm text-red-500 hover:underline w-full text-center">ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦æ¶ˆå»</button>
        </section>

    </main>

    <script>
        // æ—¥ä»˜è¡¨ç¤º
        document.getElementById('currentDate').innerText = new Date().toLocaleDateString('ja-JP');

        let records = JSON.parse(localStorage.getItem('headacheRecords')) || [];
        let myChart;

        // ä¿å­˜å‡¦ç†
        document.getElementById('headacheForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const newRecord = {
                id: Date.now(),
                date: new Date().toLocaleString('ja-JP', {month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit'}),
                intensity: document.getElementById('intensity').value,
                location: document.getElementById('location').value,
                medication: document.getElementById('medication').value,
                memo: document.getElementById('memo').value
            };
            records.unshift(newRecord);
            localStorage.setItem('headacheRecords', JSON.stringify(records));
            updateUI();
            e.target.reset();
        });

        // UIæ›´æ–°
        function updateUI() {
            const list = document.getElementById('historyList');
            list.innerHTML = '';
            
            records.forEach(r => {
                const div = document.createElement('div');
                div.className = "bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex justify-between items-center";
                div.innerHTML = `
                    <div>
                        <div class="text-xs text-gray-400">${r.date}</div>
                        <div class="font-bold text-gray-700">${r.location} - å¼·ã• ${r.intensity}</div>
                        <div class="text-sm text-gray-500">${r.memo || 'ãƒ¡ãƒ¢ãªã—'}</div>
                    </div>
                    <div class="px-3 py-1 rounded-full text-xs font-semibold ${r.medication === 'ã‚ã‚Š' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-500'}">
                        è–¬:${r.medication}
                    </div>
                `;
                list.appendChild(div);
            });

            updateChart();
        }

        // ã‚°ãƒ©ãƒ•æ›´æ–°
        function updateChart() {
            const ctx = document.getElementById('headacheChart').getContext('2d');
            const data = [...records].reverse().slice(-7); // ç›´è¿‘7ä»¶

            if (myChart) myChart.destroy();
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(r => r.date),
                    datasets: [{
                        label: 'ç—›ã¿ã®å¼·ã•',
                        data: data.map(r => r.intensity),
                        borderColor: '#4f46e5',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    scales: { y: { min: 0, max: 10 } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // æ¶ˆå»å‡¦ç†
        document.getElementById('clearData').addEventListener('click', () => {
            if(confirm('ã™ã¹ã¦ã®è¨˜éŒ²ã‚’æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem('headacheRecords');
                records = [];
                updateUI();
            }
        });

        // åˆå›èª­ã¿è¾¼ã¿
        updateUI();
    </script>
</body>
</html>